# electron 开发的问题

### Q1 首次渲染体验

问题表现：有短暂的白屏

问题分析：
加载分为几个阶段：

- application 准备阶段
- browserWindow 准备阶段
- 内容加载阶段，就是常规的 web 首屏渲染

application 准备阶段没啥搞头，在进入 ready 阶段后打开 browserWindow 属于常规操作

browserWindow 准备阶段，这里会有一小段时间白屏（加载 web asset，css js 这些东西，可以用性能分析工具看）

内容加载阶段，没啥好讲的，按照常规的 web 加载去理解

问题解决：
从以上分析可以知道，我们可以得出两个优化的方向，

一、窗口准备的阶段，可以分几种处理

- 我们可以先隐藏窗口，随即等到窗口内容完成首次渲染（useEffect）以后，通过进程通讯协议，让后台进程打开窗口
- 在 app.html 直接加一个全屏 loading 的默认样式，这里不使用`外联样式`是为了争取在首次 layout 阶段（参考 css 渲染机制）就完成绘制

二、web 优化手段去处理，且文件传输基于 file://协议，基本不大存在网络优化的问题（除非升级应用的架构上是类似 hybrid 更新方式，这样需要缓存策略的参与，工程复杂度提高）

### Q2 多系统的兼容

常常表现为：

- 白屏（指应用崩溃），开发阶段不出现问题，上生成后投放到 windows 系统下会出现，调查后发现基本都是.NET Framework 缺失或者版本问题，因为 electron 就是一个 Chrome 浏览器，需要动态链接一些系统库，因此依赖于.NET Framework

- 通过终端命令行调取一些信息，时常会碰到兼容问题，这个其实好理解。实际问题实际分析，做兼容即可。

### Q3 应用更新

有两种方式：

- 全量升级，意思是更新整个客户端
- 增量升级，升级机制跟移动端的 hybrid 类似，通过更新 web 内容达到更新的目的
